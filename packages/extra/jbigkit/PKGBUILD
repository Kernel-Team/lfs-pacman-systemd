#-*-mode:sh-*-
# Maintainer: alexforsale@yahoo.com
pkgname=jbigkit
pkgver=2.1
pkgrel=1
pkgdesc="Data compression library/utilities for bi-level high-resolution images"
arch=('x86_64')
url="http://www.cl.cam.ac.uk/~mgk25/jbigkit/"
license=('GPL')
depends=()
options=('staticlibs')
source=(https://www.cl.cam.ac.uk/~mgk25/download/jbigkit-$pkgver.tar.gz)
sha256sums=('de7106b6bfaf495d6865c7dd7ac6ca1381bd12e0d81405ea81e7f2167263d932')
groups=('extra')

build() {
    cd "$srcdir"/$pkgname-$pkgver
    unset CFLAGS CPPFLAGS LDFLAGS
    [ "$CARCH" == "x86_64" ] && export CFLAGS="$CFLAGS -fPIC"
    make CFLAGS="$CFLAGS"
}

package() {
    cd "$srcdir"/$pkgname-$pkgver

    install -D -m644 libjbig/libjbig.a "$pkgdir"/usr/local/lib/libjbig.a
    install -D -m644 libjbig/libjbig85.a "$pkgdir"/usr/local/lib/libjbig85.a
    install -D -m644 libjbig/jbig.h "$pkgdir"/usr/local/include/jbig.h
    install -D -m644 libjbig/jbig_ar.h "$pkgdir"/usr/local/include/jbig_ar.h
    install -D -m644 libjbig/jbig85.h "$pkgdir"/usr/local/include/jbig85.h

    install -d -m755 "$pkgdir"/usr/local/share/man/man1
    #  install -d -m755 "$pkgdir"/usr/local/share/man/man5
    install -m644 pbmtools/*.1* "$pkgdir"/usr/local/share/man/man1
    #  install -m644 pbmtools/*.5* "$pkgdir"/usr/local/share/man/man5

    install -D -m755 pbmtools/jbgtopbm "$pkgdir"/usr/local/bin/jbgtopbm
    install -D -m755 pbmtools/pbmtojbg "$pkgdir"/usr/local/bin/pbmtojbg
    install -D -m755 pbmtools/jbgtopbm85 "$pkgdir"/usr/local/bin/jbgtopbm85
    install -D -m755 pbmtools/pbmtojbg85 "$pkgdir"/usr/local/bin/pbmtojbg85

    rm -f "$pkgdir"/usr/local/share/man/man5/p{b,g}m.5*
}

sha256sums=('de7106b6bfaf495d6865c7dd7ac6ca1381bd12e0d81405ea81e7f2167263d932')
